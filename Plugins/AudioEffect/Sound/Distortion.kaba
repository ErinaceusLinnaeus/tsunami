# Image = hui:properties
# Title[Deutsch] = Verzerrer
use tsunami

const string AUTO_CONFIG_GAIN = "0:1:0.1:100:%"

class Config extends Module.Config
	float gain
	override void reset()
		gain = 0.1

class Distortion extends AudioEffect
	Config config


	override void process(out AudioBuffer buf)
		float a = max(10000 * pow(config.gain, 2), 0.01)
		float b = 1 / atan(a)
	
		for c in buf.c
			for x in c
				x = b * atan(x * a)
