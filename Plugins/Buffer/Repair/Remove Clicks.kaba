// Image = hui:clear
// Title[Deutsch] = Klicks Entfernen
use "../../api.kaba"

class RemoveClicks : AudioEffect
	void unclick(float[] b)
		for i in 1:b.num-1
			float m = (b[i-1] + b[i+1]) / 2
			if abs(b[i-1] - b[i+1]) < 0.1 and abs(b[i] - m) > 0.4
				b[i] = m

	overwrite void process(BufferBox buf)
		unclick(buf.r)
		unclick(buf.l)
